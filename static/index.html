<html>
    <head>
        <title>Nexus</title>
        <link rel="icon" href="./static/favicon.svg">
        <link rel="stylesheet" href="./static/output.css">
        <script src="https://unpkg.com/htmx.org@2.0.4"></script>
    </head>
    <body class="bg-black text-white flex flex-col items-center justify-center p-8 gap-8">
        <input
            class="bg-zinc-700 text-center text-white rounded-md p-2 w-1/2"
            type="search"
            name="filter"
            placeholder="Begin typing to search..."
            hx-get="/properties/"
            hx-trigger="input changed delay:100ms, keyup[key=='Enter'], load"
            hx-target="#results"
        >
        <table class="text-center">
            <thead>
                <tr>
                    <th class="px-4 py-2">ID</th>
                    <th class="px-4 py-2">Name</th>
                    <th class="px-4 py-2">Address</th>
                    <th class="px-4 py-2">Demo</th>
                    <th class="px-4 py-2">Point of Contact</th>
                    <th class="px-4 py-2">Manager</th>
                    <th class="px-4 py-2">Client ID</th>
                </tr>
            </thead>
            <tbody id="results">
                {{range .Properties}}
                <tr>
                    <td class="px-4 py-2">{{.PkPropertyID}}</td>
                    <td class="px-4 py-2">{{.Name}}</td>
                    <td class="px-4 py-2">{{.Address}}</td>
                    <td class="px-4 py-2">{{if .IsDemo}}Yes{{else}}No{{end}}</td>
                    <td class="px-4 py-2">{{if .PointOfContactID.Valid}}{{.PointOfContactFirstName.String}} {{.PointOfContactLastName.String}}{{else}}-{{end}}</td>
                    <td class="px-4 py-2">{{if .ManagerID.Valid}}{{.ManagerFirstName.String}} {{.ManagerLastName.String}}{{else}}-{{end}}</td>
                    <td class="px-4 py-2">{{.FkClientID}}</td>
                </tr>
                {{end}}
                {{if .NextPage}}
                <tr hx-get="/properties/page={{ .NextPage }}"
                    hx-trigger="revealed"
                    hx-swap="afterend">
                    <td class="px-4 py-2">{{.Last.PkPropertyID}}</td>
                    <td class="px-4 py-2">{{.Last.Name}}</td>
                    <td class="px-4 py-2">{{.Last.Address}}</td>
                    <td class="px-4 py-2">{{if .Last.IsDemo}}Yes{{else}}No{{end}}</td>
                    <td class="px-4 py-2">{{if .Last.PointOfContactID.Valid}}{{.Last.PointOfContactFirstName.String}} {{.Last.PointOfContactLastName.String}}{{else}}-{{end}}</td>
                    <td class="px-4 py-2">{{if .Last.ManagerID.Valid}}{{.Last.ManagerFirstName.String}} {{.Last.ManagerLastName.String}}{{else}}-{{end}}</td>
                    <td class="px-4 py-2">{{.Last.FkClientID}}</td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </body>
</html>